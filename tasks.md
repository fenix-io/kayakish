# Glossary Review - Findings & Proposed Changes

## Summary
Cross-referenced all 80+ glossary terms against source code (`src/`), tests (`test/`), visualization (`visualization/`), and documentation (`docs/`). Found several categories of issues.

---

## A. CRITICAL: Y-Axis Convention Conflict

The **code and data** treat **y+ = starboard**, **y- = port**:
- `k05.hull`: "starboard gunnel" curves have positive y values
- `visualization/script.js`: Port on left (negative), Starboard on right (positive)
- Hull mirroring in `hull.py`: mirrors positive-y to negative-y

**The Glossary is CORRECT** (y+ = starboard).

But these other sources are **WRONG** (they say y+ = port):
- `.github/copilot-instructions.md`
- `docs/Architecture.md`
- `test/scripts/visualize_profile.py` axis label

### Proposed Fix
- [x] Fix `.github/copilot-instructions.md`: change y-axis description to "positive from centerline to starboard"
- [x] Fix `docs/Architecture.md`: update coordinate system section
- [x] Fix `test/scripts/visualize_profile.py`: swap port/starboard axis label
- [x] No change needed in Glossary (it's correct)

---

## B. Integration Method Mismatch

The Glossary prominently references **Simpson's Rule** and **Trapezoidal Rule** as the calculation methods. The code actually uses:
- **Shoelace formula** for cross-section area (`profile.py`)
- **Slab method** (area × step_width) for volume integration (`hull.py`, `profile.py`)

Neither Simpson's Rule nor Trapezoidal Rule appears anywhere in the codebase.

### Proposed Fix
- [x] Add **Shoelace Formula** glossary entry
- [x] Add **Slab Integration** glossary entry
- [x] Update **Integration** and **Numerical Integration** entries to reference actual methods used
- [x] Update **Simpson's Rule** to note it's a reference method, not currently implemented
- [x] Update **Related Standards** section accordingly

---

## C. Missing Terms (used in code, absent from Glossary)

| Term | Where Used | Priority |
|------|-----------|----------|
| **Spline / Spline3D** | `spline.py` - core geometry class | High |
| **Curve** | `curve.py` - named hull curve with mirrored flag | High |
| **PCHIP** | `spline.py` - primary interpolation method | High |
| **Shoelace Formula** | `profile.py` - area calculation | High |
| **target_waterline** | `hull.py` - initial waterline guess | Medium |
| **target_weight** | `hull.py` - empty hull mass | Medium |
| **target_payload** | `hull.py` - paddler + gear mass | Medium |
| **Chord Length Parametrization** | `spline.py` - curve parametrization | Medium |
| **Slab Integration** | `hull.py` - volume integration method | Medium |
| **.hull file format** | `routes/hull.py` - persistence format | Low |
| **sanitize_filename** | `filename.py` - utility function | Low |

### Proposed Fix
- [x] Add glossary entries for High and Medium priority terms

---

## D. Glossary Definitions that Don't Match Code

### 1. Profile Definition
- **Glossary says**: "Defined by a series of points representing the hull contour"
- **Code reality**: Profiles are auto-generated by evaluating spline curves at a given x-coordinate; users define curves, not profiles directly

### 2. Weight vs Mass
- Code uses `target_weight` and `target_payload` in **kg (mass)**, not Newtons (force)
- Glossary defines Weight as force in Newtons
- Proposal: Clarify that in code context, "weight" refers to mass in kg

### 3. Coordinate Origin
- **Glossary says**: "often amidships"
- **Code uses**: x=0 at stern, z=0 at keel bottom

### 4. Interpolation Types
- **Glossary lists**: Linear, Cubic, Spline
- **Code uses**: PCHIP (primary), CubicSpline (chord-length), Linear (waterline only)

### 5. Point3D `level` attribute
- Docstring mentions `level` parameter but `__slots__` only has `(x, y, z)` — attribute doesn't exist

### Proposed Fix
- [x] Update Profile definition to reflect curve-based generation
- [x] Clarify weight/mass convention in Weight entry
- [x] Fix Origin definition to match actual convention (stern-based)
- [x] Update Interpolation entry with actual methods
- [x] Fix Point3D docstring (remove `level` reference) — code fix, not glossary
- [x] Clarify weight uses kgf (kilogram-force), not Newtons — **DONE**

---

## E. Obsolete/Aspirational Terms

These terms have glossary entries but no corresponding code implementation. They may describe planned features or general naval knowledge:

**No code implementation exists for:**
- Apex Point, Multi-Point Bow/Stern, Level (point attribute)
- GM (Metacentric Height), Metacenter, Initial Stability, Secondary Stability
- Stability Criteria, Aspect Ratio, LOA, Waterplane area
- Wetted Surface, Freeboard, Reserve Buoyancy, Sheer, Cockpit, Deck
- Rocker, Tracking, Waterline Length

### Proposed Fix
- [x] Mark aspirational/unimplemented terms with a note like "*Not currently computed by the application*"
- [x] Keep terms that are useful general reference (GM, Metacenter, etc.)

---

## F. Document Reference Fix

The glossary footer says:
> "see the USER_GUIDE.md and example scripts"

### Proposed Fix
- [x] Change to: "see the [User Guide](User_Guide.md) and [example scripts](../test/scripts/)"
- [x] Change "Kayak Calculation Tool" to "Kayakish"

---

## G. Minor Code Issues Found (not Glossary)

1. **Rotation convention inconsistency**: `Point3D.rotate_x()` negates the angle; `Spline3D.apply_rotation_on_x_axis()` does not. Both are used for heel. The stability pipeline only uses the spline method, so no runtime bug, but API inconsistency.
2. **Typo in k05.hull**: "starborad gunnel" should be "starboard gunnel"
3. **Stale docstring**: Point3D mentions `level` parameter that doesn't exist

---

## Recommended Execution Order

1. ~~Fix Glossary content (integration methods, missing terms, definitions, references)~~ **DONE**
2. ~~Fix y-axis convention in copilot-instructions.md + Architecture.md~~ **DONE**
3. ~~Fix Point3D stale docstring~~ **DONE**
4. ~~Fix k05.hull typo ("starborad" → "starboard")~~ **DONE**
5. ~~Fix Weight/Mass convention (D.2) — clarified as kgf~~ **DONE**

---

# Resistance & Performance Analysis

> Planning document: [docs/Resistance_analysis_planning.md](docs/Resistance_analysis_planning.md)

## Phase 1: Geometry Extensions

- [ ] **R1. Wetted Surface Area** — Add `wetted_perimeter()` to `Profile` and integrate along hull length in `Hull` to compute total wetted surface area $S_w$.
- [ ] **R2. Waterline Length & Beam** — Add `waterline_length()` and `waterline_beam()` methods to `Hull`, finding the extent of the hull at the computed waterline.
- [ ] **R3. Hull Form Coefficients** — Compute block coefficient ($C_b$), prismatic coefficient ($C_p$), midship coefficient ($C_m$), and waterplane coefficient ($C_{wp}$) from existing volume/area data. Add to a new `src/analysis/hull_parameters.py` module.

## Phase 2: Resistance Calculations

- [ ] **R4. Frictional Resistance (ITTC 1957)** — Implement `calculate_frictional_resistance(speed, Lw, Sw)` using the ITTC correlation line and Reynolds number in `src/analysis/resistance.py`.
- [ ] **R5. Residuary (Wave-Making) Resistance** — Implement empirical $C_r$ vs Froude number model for slender displacement hulls in `src/analysis/resistance.py`.
- [ ] **R6. Total Resistance & Power Curves** — Combine frictional + residuary resistance; compute effective power ($P = R \times V$), paddler power (with efficiency factor), and hull speed estimate.

## Phase 3: API & Visualization

- [ ] **R7. API Endpoint** — Add a `/hull/{name}/resistance` route that returns resistance, power, and performance data for a speed range.
- [ ] **R8. Visualization** — Add resistance/power curve charts to the HTML visualization (similar to stability curve display).

## Phase 4: Testing & Documentation

- [ ] **R9. Unit Tests** — Write tests for wetted surface, form coefficients, ITTC friction, residuary resistance, and power calculations.
- [ ] **R10. Documentation** — Update `docs/Architecture.md` and `docs/User_Guide.md` with the new resistance analysis feature.
